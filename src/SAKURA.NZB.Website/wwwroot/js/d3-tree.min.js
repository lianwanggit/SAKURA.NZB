function branch(e){var t,r,a=endPt(e);branches.push(e),e.d!==maxDepth&&(t=ar*Math.random()-.5*ar,r={i:branches.length,x:a.x,y:a.y,a:e.a-da+t,l:e.l*dl,d:e.d+1,parent:e.i},branch(r),t=ar*Math.random()-.5*ar,r={i:branches.length,x:a.x,y:a.y,a:e.a+da+t,l:e.l*dl,d:e.d+1,parent:e.i},branch(r))}function regenerate(e){branches=[],branch(seed),e?create():update()}function endPt(e){var t=e.x+e.l*Math.sin(e.a),r=e.y-e.l*Math.cos(e.a);return{x:t,y:r}}function x1(e){return e.x}function y1(e){return e.y}function x2(e){return endPt(e).x}function y2(e){return endPt(e).y}function highlightParents(e){for(var t="mouseover"===d3.event.type?"green":stroke,r=e.d,a=0;r>=a;a++)d3.select("#id-"+parseInt(e.i)).style("stroke",t),e=branches[e.parent]}function create(){d3.select("svg").selectAll("line").data(branches).enter().append("line").attr("x1",x1).attr("y1",y1).attr("x2",x2).attr("y2",y2).style("stroke-width",function(e){return parseInt(maxDepth+1-e.d)+"px"}).attr("id",function(e){return"id-"+e.i}).on("mouseover",highlightParents).on("mouseout",highlightParents)}function update(){d3.select("svg").selectAll("line").data(branches).attr("x1",x1).attr("y1",y1).attr("x2",x2).attr("y2",y2)}function recolor(){stroke=colorSheet[colorIdx%colorSheet.length],colorIdx++,d3.select("svg").selectAll("line").style("stroke",function(){return stroke}),d3.selectAll(".recolor").style("color",function(){return stroke})}var branches=[],seed={i:0,x:420,y:600,a:0,l:130,d:0},da=.5,dl=.8,ar=.7,maxDepth=7,colorIdx=0,stroke="#000000",colorSheet=["#d2d4dc","#afafaf","#f8f8fa","#e5e6eb","#c0c2ce","#ffb3ba","#ffdfba","#ffffba","#baffc9","#bae1ff","#77aaff","#99ccff","#bbeeff","#5588ff","#3366ff","#009688","#35a79c","#54b2a9","#65c3ba","#83d0c9","#a67c00","#bf9b30","#ffbf00","#ffcf40","#ffdc73","#ff00a9","#fb9f9f","#ff0065","#ffbfd3","#fb5858","#ee4035","#f37736","#fdf498","#7bc043","#0392cf","#a69eb0","#efeff2","#f2e2cd","#dadae3","#000000"];d3.selectAll(".regenerate").on("click",regenerate),d3.selectAll(".recolor").on("click",recolor),regenerate(!0);var interval=1e4;setInterval(recolor,interval),setInterval(regenerate,colorSheet.length*interval);