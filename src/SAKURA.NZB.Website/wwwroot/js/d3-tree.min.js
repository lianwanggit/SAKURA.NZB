function branch(e){var t,r,n=endPt(e);branches.push(e),e.d!==maxDepth&&(t=ar*Math.random()-.5*ar,r={i:branches.length,x:n.x,y:n.y,a:e.a-da+t,l:e.l*dl,d:e.d+1,parent:e.i},branch(r),t=ar*Math.random()-.5*ar,r={i:branches.length,x:n.x,y:n.y,a:e.a+da+t,l:e.l*dl,d:e.d+1,parent:e.i},branch(r))}function regenerate(e){branches=[],branch(seed),e?create():update()}function endPt(e){var t=e.x+e.l*Math.sin(e.a),r=e.y-e.l*Math.cos(e.a);return{x:t,y:r}}function x1(e){return e.x}function y1(e){return e.y}function x2(e){return endPt(e).x}function y2(e){return endPt(e).y}function highlightParents(e){for(var t="mouseover"===d3.event.type?"green":stroke,r=e.d,n=0;r>=n;n++)d3.select("#id-"+parseInt(e.i)).style("stroke",t),e=branches[e.parent]}function create(){d3.select("svg").selectAll("line").data(branches).enter().append("line").attr("x1",x1).attr("y1",y1).attr("x2",x2).attr("y2",y2).style("stroke-width",function(e){return parseInt(maxDepth+1-e.d)+"px"}).attr("id",function(e){return"id-"+e.i}).on("mouseover",highlightParents).on("mouseout",highlightParents)}function update(){d3.select("svg").selectAll("line").data(branches).attr("x1",x1).attr("y1",y1).attr("x2",x2).attr("y2",y2)}function recolor(){stroke=colorSheet[colorIdx%colorSheet.length],colorIdx++,d3.select("svg").selectAll("line").style("stroke",function(){return stroke})}var branches=[],seed={i:0,x:420,y:600,a:0,l:130,d:0},da=.5,dl=.8,ar=.7,maxDepth=7,colorIdx=0,stroke="#777",colorSheet=["#4b717f","#e7bda2","#17324e","#6ba6d4","#edc613","#4e8539","#a5bd97","#2585ae","#ff8d00","#a1008a","#b30707"];d3.selectAll(".regenerate").on("click",regenerate),d3.selectAll(".recolor").on("click",recolor),regenerate(!0);